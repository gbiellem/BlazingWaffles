image: Visual Studio 2019
skip_commits:
  message: /docs|Merge pull request.*/
install:
  - choco install googlechrome
  - choco install dotnetcore-sdk --no-progress --confirm --version 3.1.302
  - dotnet dev-certs https --trust
build_script:
- ps: >-
    dotnet build src --configuration Release

    dotnet test src --configuration Release --no-build --no-restore --filter Category!=Integration

    dotnet publish src\BlazingWaffles --configuration Release --no-build --no-restore --output .\publish

    mkdir package

    Compress-Archive -Path publish\wwwroot\*  -DestinationPath package\BlazingWaffles.zip

test: off
artifacts:
  - path: package\BlazingWaffles.zip
deploy:
  - provider: Environment
    name: BlazingWaffles
    on:
      branch: master